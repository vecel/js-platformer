(()=>{"use strict";class t{constructor(){this.left=new t.ButtonInput,this.right=new t.ButtonInput,this.up=new t.ButtonInput}keyDownUp(t,i){const e="keydown"===t;switch(i){case 65:case 37:this.left.getInput(e);break;case 68:case 39:this.right.getInput(e);break;case 87:case 38:this.up.getInput(e)}}}t.ButtonInput=class{constructor(){this.active=this.down=!1}getInput(t){this.down!==t&&(this.active=t),this.down=t}};const i=t;class e{constructor(){this.level={backgroundColor:"#777",height:80,width:128,world:new e.World,init:function(){this.world.init()},update:function(){this.world.update()}}}init(){this.level.init()}update(){this.level.update()}}e.Rectangle=class{constructor(t,i,e,s){this.x=t,this.y=i,this.width=e,this.height=s,this.oldX=t,this.oldY=i}setLeft(t){this.x=t}setRight(t){this.x=t-this.width}setTop(t){this.y=t}setBottom(t){this.y=t-this.height}getLeft(){return this.x}getRight(){return this.x+this.width}getTop(){return this.y}getBottom(){return this.y+this.height}setOldLeft(t){this.oldX=t}setOldRight(t){this.oldX=t-this.width}setOldTop(t){this.oldY=t}setOldBottom(t){this.oldY=t-this.height}getOldLeft(){return this.oldX}getOldRight(){return this.oldX+this.width}getOldTop(){return this.oldY}getOldBottom(){return this.oldY+this.height}},e.Player=class extends e.Rectangle{constructor(){super(32,32,5,5),this.color="#f00",this.velocity=3,this.jumpCounter=0,this.velocityX=0,this.velocityY=0}jump(){2!=this.jumpCounter&&(this.velocityY=-15,this.jumpCounter++)}moveLeft(){this.velocityX=-this.velocity}moveRight(){this.velocityX=this.velocity}update(){this.oldX=this.x,this.oldY=this.y,this.x+=this.velocityX,this.y+=this.velocityY,console.log(this.velocityY)}},e.World=class{constructor(t){this.mapSketch=["X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X",".",".",".","X",".",".",".",".",".","X","X","X","X",".",".","X","X","X",".",".","X","X",".","X",".",".",".","X","X","X",".",".",".",".","X","X",".","X","X",".",".",".",".",".",".",".",".",".","X",".",".",".","X","X",".",".",".",".",".",".",".","X",".",".",".",".",".",".","X",".","X","X",".",".",".",".",".",".",".","X",".",".",".",".",".",".",".",".","X","X","X",".",".","X","X",".",".","X","X",".",".","X",".",".","X",".","X","X","X",".",".","X",".",".",".","X",".",".",".",".",".","X","X",".","X","X","X",".","X",".",".",".",".",".",".",".",".",".",".","X","X",".","X","X",".",".","X",".",".",".",".",".",".",".","X",".",".",".","X",".","X","X",".",".","X","X",".","X","X","X",".",".","X",".",".",".","X",".","X","X",".",".","X","X",".",".","X",".",".","X","X",".",".","X","X",".","X","X","X",".",".",".",".",".","X",".",".","X","X","X",".","X","X",".","X","X",".",".",".",".",".",".",".",".",".",".","X","X",".",".","X",".","X","X",".",".","X","X",".",".",".",".",".",".","X","X",".",".",".",".","X","X",".",".",".",".",".","X",".",".",".",".","X","X",".",".","X",".","X","X",".",".",".",".",".",".",".",".",".","X","X","X","X",".","X",".","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X","X"],this.collisionMap=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,1,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,1,0,0,1,1,0,0,1,0,0,1,0,1,1,1,0,0,1,0,0,0,1,0,0,0,0,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,1,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,0,1,1,0,1,1,1,0,0,1,0,0,0,1,0,1,1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,1,0,1,1,1,0,0,0,0,0,1,0,0,1,1,1,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],this.collider=new e.World.Collider,this.columns=18,this.rows=18,this.tileSize=8,this.map=[],this.player=new e.Player,this.gravity=3,this.friction=.7,this.offsetX=0,this.offsetY=0,this.width=128,this.height=80}init(){this.initMap()}initMap(){for(let t=0;t<=this.mapSketch.length;++t)"X"===this.mapSketch[t]&&this.map.push(new e.Tile(t%this.columns*this.tileSize,Math.floor(t/this.columns)*this.tileSize,this.tileSize,this.tileSize,this.mapSketch[t]))}collideObject(t){let i,e,s,h,l;i=Math.floor((t.getLeft()-this.offsetX)/this.tileSize),s=Math.floor((t.getTop()-this.offsetY)/this.tileSize),l=this.collisionMap[s*this.columns+i],this.collider.collide(l,t,i*this.tileSize,s*this.tileSize,this.tileSize,this.offsetX,this.offsetY),e=Math.floor((t.getRight()-this.offsetX)/this.tileSize),s=Math.floor((t.getTop()-this.offsetY)/this.tileSize),l=this.collisionMap[s*this.columns+e],this.collider.collide(l,t,e*this.tileSize,s*this.tileSize,this.tileSize,this.offsetX,this.offsetY),i=Math.floor((t.getLeft()-this.offsetX)/this.tileSize),h=Math.floor((t.getBottom()-this.offsetY)/this.tileSize),l=this.collisionMap[h*this.columns+i],this.collider.collide(l,t,i*this.tileSize,h*this.tileSize,this.tileSize,this.offsetX,this.offsetY),e=Math.floor((t.getRight()-this.offsetX)/this.tileSize),h=Math.floor((t.getBottom()-this.offsetY)/this.tileSize),l=this.collisionMap[h*this.columns+e],this.collider.collide(l,t,e*this.tileSize,h*this.tileSize,this.tileSize,this.offsetX,this.offsetY),t.getLeft()<this.tileSize&&(this.offsetX+=this.tileSize-t.getLeft(),t.setLeft(this.tileSize)),t.getRight()>this.width-this.tileSize&&(this.offsetX+=-this.tileSize+this.width-t.getRight(),t.setRight(this.width-this.tileSize)),t.getTop()<this.tileSize&&(this.offsetY+=this.tileSize-t.getTop(),t.setTop(this.tileSize)),t.getBottom()>this.height-this.tileSize&&(this.offsetY+=-this.tileSize+this.height-t.getBottom(),t.setBottom(this.height-this.tileSize))}update(){this.player.velocityY+=this.gravity,this.player.velocityX*=this.friction,this.player.velocityY=Math.min(this.player.velocityY,this.tileSize),this.player.update(),this.collideObject(this.player)}},e.Tile=class extends e.Rectangle{constructor(t,i,e,s,h){super(t,i,e,s),this.id=h}},e.World.Collider=class{constructor(){}collide(t,i,e,s,h,l,o){if(1===t){if(this.collidePlatformTop(i,s+o-.01))return;if(this.collidePlatformLeft(i,e+l-.01))return;if(this.collidePlatformRight(i,e+h+l+.01))return;if(this.collidePlatformBottom(i,s+h+o+.01))return}}collidePlatformLeft(t,i){return t.getRight()>i&&t.getOldRight()<=i&&(t.setRight(i-.01),t.velocityX=0,!0)}collidePlatformRight(t,i){return t.getLeft()<i&&t.getOldLeft()>=i&&(t.setLeft(i+.01),t.velocityX=0,!0)}collidePlatformTop(t,i){return t.getBottom()>i&&t.getOldBottom()<=i&&(t.setBottom(i-.01),t.velocityY=0,t.jumpCounter=0,!0)}collidePlatformBottom(t,i){return t.getTop()<i&&t.getOldTop()>=i&&(t.setTop(i),t.velocityY=0,!0)}};const s=e;window.addEventListener("load",(t=>{const e=function(t){l.keyDownUp(t.type,t.keyCode)},h=function(){o.resize(document.documentElement.clientWidth-32,document.documentElement.clientHeight-32,n.level.height/n.level.width),o.render()};let l=new i,o=new class{constructor(t){this.buffer=document.createElement("canvas").getContext("2d"),this.context=t.getContext("2d")}drawPlayer(t,i,e,s,h){this.buffer.fillStyle=h,this.buffer.fillRect(Math.round(t),Math.round(i),e,s)}drawTile(t,i,e,s,h){this.buffer.fillStyle="#f0f",this.buffer.fillRect(t,i,e,s)}fill(t){this.buffer.fillStyle=t,this.buffer.fillRect(0,0,this.buffer.canvas.width,this.buffer.canvas.height)}render(){this.context.drawImage(this.buffer.canvas,0,0,this.buffer.canvas.width,this.buffer.canvas.height,0,0,this.context.canvas.width,this.context.canvas.height)}resize(t,i,e){i/t>e?(this.context.canvas.height=t*e,this.context.canvas.width=t):(this.context.canvas.height=i,this.context.canvas.width=i/e),this.context.imageSmoothingEnabled=!1}}(document.querySelector("canvas")),n=new s,r=new class{constructor(t,i,e){this.accumulatedTime=0,this.animationFrameRequest=void 0,this.time=void 0,this.timeStep=t,this.updated=!1,this.update=i,this.render=e}handleRun(t){this.run(t)}run(t){for(this.accumulatedTime+=t-this.time,this.time=t;this.accumulatedTime>=this.timeStep;)this.accumulatedTime-=this.timeStep,this.update(),this.updated=!0;this.updated&&(this.updated=!1,this.render()),this.animationFrameRequest=window.requestAnimationFrame(this.handleRun.bind(this))}start(){this.accumulatedTime=this.timeStep,this.time=window.performance.now(),this.animationFrameRequest=window.requestAnimationFrame(this.handleRun.bind(this))}stop(){window.cancelAnimationFrame(this.animationFrameRequest)}}(1e3/30,(function(){l.left.active&&n.level.world.player.moveLeft(),l.right.active&&n.level.world.player.moveRight(),l.up.active&&(n.level.world.player.jump(),l.up.active=!1),n.update()}),(function(){o.fill(n.level.backgroundColor),n.level.world.map.forEach((t=>{o.drawTile(t.x+n.level.world.offsetX,t.y+n.level.world.offsetY,t.width,t.height,t.id)})),o.drawPlayer(n.level.world.player.x,n.level.world.player.y,n.level.world.player.width,n.level.world.player.height,n.level.world.player.color),o.render()}));o.buffer.canvas.width=n.level.width,o.buffer.canvas.height=n.level.height,window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("resize",h),h(),n.init(),r.start()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUNyRixJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFDckYsSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQ3JGLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUNyRixJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFDckYsSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQ3JGLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUNyRixJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFDckYsSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQ3JGLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxJQUFLLElBQUssSUFBSyxLQUVqR3RELEtBQUt1RCxhQUFlLENBQ1IsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQ25ELEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUNuRCxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDbkQsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQ25ELEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUNuRCxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDbkQsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQ25ELEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUNuRCxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFDbkQsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVBQUcsRUFBRyxFQUFHLEVB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QU1pRCxRQUFTd0UsRUFBS25ILEVBQUlnRixFQUFLMUYsTUFBTUksTUFBTWtELFFBQVN1RSxFQUFLMUgsTUFBTzBILEVBQUszSCxPQUFRMkgsRUFBS3hELE9BSXpIZ0IsRUFBUVksV0FBV1AsRUFBSzFGLE1BQU1JLE1BQU04QyxPQUFPekMsRUFBR2lGLEVBQUsxRixNQUFNSSxNQUFNOEMsT0FBT3hDLEVBQUdnRixFQUFLMUYsTUFBTUksTUFBTThDLE9BQU8vQyxNQUFPdUYsRUFBSzFGLE1BQU1JLE1BQU04QyxPQUFPaEQsT0FBUXdGLEVBQUsxRixNQUFNSSxNQUFNOEMsT0FBT25CLE9BRWhLc0QsRUFBUU0sWUEwQlpOLEVBQVFRLE9BQU9ELE9BQU96RixNQUFRdUYsRUFBSzFGLE1BQU1HLE1BQ3pDa0YsRUFBUVEsT0FBT0QsT0FBTzFGLE9BQVN3RixFQUFLMUYsTUFBTUUsT0FFMUM4RSxPQUFPQyxpQkFBaUIsVUFBV3hGLEdBQ25DdUYsT0FBT0MsaUJBQWlCLFFBQVd4RixHQUNuQ3VGLE9BQU9DLGlCQUFpQixTQUFXRyxHQUVuQ0EsSUFFQU0sRUFBS3BGLE9BQ0xxRyxFQUFPWSxZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vanMtcGxhdGZvcm1lci8uL3NyYy9jb250cm9sbGVyLmpzIiwid2VicGFjazovL2pzLXBsYXRmb3JtZXIvLi9zcmMvZ2FtZS5qcyIsIndlYnBhY2s6Ly9qcy1wbGF0Zm9ybWVyLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL2pzLXBsYXRmb3JtZXIvLi9zcmMvZGlzcGxheS5qcyIsIndlYnBhY2s6Ly9qcy1wbGF0Zm9ybWVyLy4vc3JjL2VuZ2luZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDb250cm9sbGVyIHtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuXG4gICAgICAgIHRoaXMubGVmdCAgPSBuZXcgQ29udHJvbGxlci5CdXR0b25JbnB1dCgpO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gbmV3IENvbnRyb2xsZXIuQnV0dG9uSW5wdXQoKTtcbiAgICAgICAgdGhpcy51cCAgICA9IG5ldyBDb250cm9sbGVyLkJ1dHRvbklucHV0KCk7XG5cbiAgICB9XG5cbiAgICBrZXlEb3duVXAodHlwZSwga2V5Q29kZSkge1xuXG4gICAgICAgIGNvbnN0IGRvd24gPSAodHlwZSA9PT0gJ2tleWRvd24nKSA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICBzd2l0Y2ggKGtleUNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgNjU6XG4gICAgICAgICAgICBjYXNlIDM3OlxuICAgICAgICAgICAgICAgIHRoaXMubGVmdC5nZXRJbnB1dChkb3duKTsgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDY4OlxuICAgICAgICAgICAgY2FzZSAzOTpcbiAgICAgICAgICAgICAgICB0aGlzLnJpZ2h0LmdldElucHV0KGRvd24pOyBicmVhaztcbiAgICAgICAgICAgIGNhc2UgODc6XG4gICAgICAgICAgICBjYXNlIDM4OlxuICAgICAgICAgICAgICAgIHRoaXMudXAuZ2V0SW5wdXQoZG93bik7IGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgfVxuXG5cbn1cblxuQ29udHJvbGxlci5CdXR0b25JbnB1dCA9IGNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcblxuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRoaXMuZG93biA9IGZhbHNlO1xuXG4gICAgfVxuXG4gICAgZ2V0SW5wdXQoZG93bikge1xuXG4gICAgICAgIGlmICh0aGlzLmRvd24gIT09IGRvd24pIHRoaXMuYWN0aXZlID0gZG93bjtcbiAgICAgICAgdGhpcy5kb3duID0gZG93bjtcblxuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IENvbnRyb2xsZXI7XG4iLCJcblxuY2xhc3MgR2FtZSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG5cbiAgICAgICAgdGhpcy5sZXZlbCA9IHtcblxuICAgICAgICAgICAgYmFja2dyb3VuZENvbG9yOiAnIzc3NycsXG4gICAgICAgICAgICBoZWlnaHQ6IDgwLFxuICAgICAgICAgICAgd2lkdGg6IDEyOCxcblxuICAgICAgICAgICAgd29ybGQ6IG5ldyBHYW1lLldvcmxkKCksXG5cbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHRoaXMud29ybGQuaW5pdCgpO1xuXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIHRoaXMud29ybGQudXBkYXRlKCk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluaXQoKSB7XG5cbiAgICAgICAgdGhpcy5sZXZlbC5pbml0KCk7XG5cbiAgICB9XG5cbiAgICB1cGRhdGUoKSB7XG5cbiAgICAgICAgdGhpcy5sZXZlbC51cGRhdGUoKTtcblxuICAgIH1cbn1cblxuR2FtZS5SZWN0YW5nbGUgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoeCwgeSwgd2lkdGgsIGhlaWdodCkge1xuXG4gICAgICAgIHRoaXMueCAgICAgID0geDtcbiAgICAgICAgdGhpcy55ICAgICAgPSB5O1xuICAgICAgICB0aGlzLndpZHRoICA9IHdpZHRoO1xuICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgdGhpcy5vbGRYICAgPSB4O1xuICAgICAgICB0aGlzLm9sZFkgICA9IHk7XG5cbiAgICB9XG5cbiAgICBzZXRMZWZ0KHgpICAgeyB0aGlzLnggPSB4OyB9XG4gICAgc2V0UmlnaHQoeCkgIHsgdGhpcy54ID0geCAtIHRoaXMud2lkdGg7IH1cbiAgICBzZXRUb3AoeSkgICAgeyB0aGlzLnkgPSB5OyB9XG4gICAgc2V0Qm90dG9tKHkpIHsgdGhpcy55ID0geSAtIHRoaXMuaGVpZ2h0OyB9XG5cbiAgICBnZXRMZWZ0KCkgICB7IHJldHVybiB0aGlzLng7IH1cbiAgICBnZXRSaWdodCgpICB7IHJldHVybiB0aGlzLnggKyB0aGlzLndpZHRoOyB9XG4gICAgZ2V0VG9wKCkgICAgeyByZXR1cm4gdGhpcy55OyB9XG4gICAgZ2V0Qm90dG9tKCkgeyByZXR1cm4gdGhpcy55ICsgdGhpcy5oZWlnaHQ7IH1cblxuICAgIHNldE9sZExlZnQoeCkgICB7IHRoaXMub2xkWCA9IHg7IH1cbiAgICBzZXRPbGRSaWdodCh4KSAgeyB0aGlzLm9sZFggPSB4IC0gdGhpcy53aWR0aDsgfVxuICAgIHNldE9sZFRvcCh5KSAgICB7IHRoaXMub2xkWSA9IHk7IH1cbiAgICBzZXRPbGRCb3R0b20oeSkgeyB0aGlzLm9sZFkgPSB5IC0gdGhpcy5oZWlnaHQ7IH1cblxuICAgIGdldE9sZExlZnQoKSAgIHsgcmV0dXJuIHRoaXMub2xkWDsgfVxuICAgIGdldE9sZFJpZ2h0KCkgIHsgcmV0dXJuIHRoaXMub2xkWCArIHRoaXMud2lkdGg7IH1cbiAgICBnZXRPbGRUb3AoKSAgICB7IHJldHVybiB0aGlzLm9sZFk7IH1cbiAgICBnZXRPbGRCb3R0b20oKSB7IHJldHVybiB0aGlzLm9sZFkgKyB0aGlzLmhlaWdodDsgfVxufVxuXG5HYW1lLlBsYXllciA9IGNsYXNzIGV4dGVuZHMgR2FtZS5SZWN0YW5nbGUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcigzMiwgMzIsIDUsIDUpOyAvLyBpbml0aWFsIHBsYXllciB2YWx1ZXNcblxuICAgICAgICB0aGlzLmNvbG9yICAgICAgID0gJyNmMDAnO1xuICAgICAgICB0aGlzLnZlbG9jaXR5ICAgID0gMztcblxuICAgICAgICB0aGlzLmp1bXBDb3VudGVyID0gMDtcbiAgICAgICAgdGhpcy52ZWxvY2l0eVggICA9IDA7XG4gICAgICAgIHRoaXMudmVsb2NpdHlZICAgPSAwO1xuXG4gICAgfVxuXG4gICAganVtcCgpIHtcblxuICAgICAgICBpZiAodGhpcy5qdW1wQ291bnRlciA9PSAyKSByZXR1cm47XG5cbiAgICAgICAgdGhpcy52ZWxvY2l0eVkgPSAtMTU7XG4gICAgICAgIHRoaXMuanVtcENvdW50ZXIrKztcblxuICAgIH1cblxuICAgIG1vdmVMZWZ0KCkge1xuXG4gICAgICAgIHRoaXMudmVsb2NpdHlYID0gLXRoaXMudmVsb2NpdHk7XG5cbiAgICB9XG5cbiAgICBtb3ZlUmlnaHQoKSB7XG5cbiAgICAgICAgdGhpcy52ZWxvY2l0eVggPSB0aGlzLnZlbG9jaXR5O1xuXG4gICAgfVxuXG4gICAgdXBkYXRlKCkge1xuXG4gICAgICAgIHRoaXMub2xkWCA9IHRoaXMueDtcbiAgICAgICAgdGhpcy5vbGRZID0gdGhpcy55O1xuXG4gICAgICAgIHRoaXMueCArPSB0aGlzLnZlbG9jaXR5WDtcbiAgICAgICAgdGhpcy55ICs9IHRoaXMudmVsb2NpdHlZO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHRoaXMudmVsb2NpdHlZKTtcbiAgICAgICAgLy8gcHJldmVudCB5IGZyb20gYmVpbmcgZ3JlYXRlciB0aGFuIHdvcmxkIGhlaWdodFxuXG4gICAgfVxufVxuXG5HYW1lLldvcmxkID0gY2xhc3Mge1xuICAgIGNvbnN0cnVjdG9yKGxldmVsSWQpIHtcblxuICAgICAgICB0aGlzLm1hcFNrZXRjaCA9IFtcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJy4nLCAnWCcsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnWCcsICdYJywgJ1gnLCAnWCcsICcuJywgJy4nLCAnWCcsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJ1gnLCAnWCcsICcuJywgJ1gnLCAnLicsICcuJywgJy4nLCAnWCcsICdYJywgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICdYJywgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnWCcsICcuJywgJy4nLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnWCcsICcuJywgJy4nLCAnWCcsICdYJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICcuJywgJ1gnLCAnLicsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnWCcsICcuJywgJy4nLCAnWCcsICcuJywgJy4nLCAnLicsICdYJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnWCcsICcuJywgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJy4nLCAnLicsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJ1gnLCAnWCcsICcuJywgJ1gnLCAnWCcsICdYJywgJy4nLCAnLicsICdYJywgJy4nLCAnLicsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJ1gnLCAnWCcsICcuJywgJy4nLCAnWCcsICcuJywgJy4nLCAnWCcsICdYJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnWCcsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnWCcsICcuJywgJy4nLCAnWCcsICdYJywgJ1gnLCAnLicsICdYJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJ1gnLCAnWCcsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICdYJywgJ1gnLCAnLicsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnLicsICcuJywgJy4nLCAnWCcsICdYJywgJ1gnLCAnWCcsICcuJywgJ1gnLCAnLicsICdYJyxcbiAgICAgICAgICAgICAgICAgICAgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJywgJ1gnLCAnWCcsICdYJ107XG5cbiAgICAgICAgdGhpcy5jb2xsaXNpb25NYXAgPSBbXG4gICAgICAgICAgICAgICAgICAgIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsIDAsIDAsIDEsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDEsIDEsIDAsIDEsIDAsIDAsIDAsIDEsIDEsIDEsIDAsIDAsIDAsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDEsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDEsIDAsIDAsIDEsIDEsIDAsIDAsIDEsIDEsIDAsIDAsIDEsIDAsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDEsIDAsIDAsIDEsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDEsIDAsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDEsIDEsIDAsIDEsIDEsIDEsIDAsIDAsIDEsIDAsIDAsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDEsIDEsIDAsIDAsIDEsIDAsIDAsIDEsIDEsIDAsIDAsIDEsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDEsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDEsIDEsIDEsIDAsIDEsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDAsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDEsIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDAsIDAsIDAsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsIDAsIDAsIDEsIDAsIDAsIDAsIDAsIDEsIDEsIDAsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsIDAsIDEsIDAsIDEsXG4gICAgICAgICAgICAgICAgICAgIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDEsIDFdO1xuXG4gICAgICAgIHRoaXMuY29sbGlkZXIgPSBuZXcgR2FtZS5Xb3JsZC5Db2xsaWRlcigpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jb2x1bW5zICAgID0gMTg7XG4gICAgICAgIHRoaXMucm93cyAgICAgICA9IDE4O1xuICAgICAgICB0aGlzLnRpbGVTaXplICA9IDg7XG5cbiAgICAgICAgdGhpcy5tYXAgPSBbXTtcblxuICAgICAgICB0aGlzLnBsYXllciA9IG5ldyBHYW1lLlBsYXllcigpO1xuXG4gICAgICAgIHRoaXMuZ3Jhdml0eSA9IDM7XG4gICAgICAgIHRoaXMuZnJpY3Rpb24gPSAwLjc7XG5cbiAgICAgICAgdGhpcy5vZmZzZXRYID0gMDtcbiAgICAgICAgdGhpcy5vZmZzZXRZID0gMDtcblxuICAgICAgICB0aGlzLndpZHRoICA9IDEyODsgIC8vIGdhbWUgc2NyZWVuXG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gODA7ICAgLy8gZ2FtZSBzY3JlZW5cblxuICAgIH1cblxuICAgIGluaXQoKSB7XG5cbiAgICAgICAgdGhpcy5pbml0TWFwKCk7XG5cbiAgICB9XG5cbiAgICBpbml0TWFwKCkge1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IHRoaXMubWFwU2tldGNoLmxlbmd0aDsgKytpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tYXBTa2V0Y2hbaV0gPT09ICdYJylcbiAgICAgICAgICAgICAgICB0aGlzLm1hcC5wdXNoKG5ldyBHYW1lLlRpbGUoKGkgJSB0aGlzLmNvbHVtbnMpICogdGhpcy50aWxlU2l6ZSwgTWF0aC5mbG9vcihpIC8gdGhpcy5jb2x1bW5zKSAqIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUsIHRoaXMubWFwU2tldGNoW2ldKSk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGNvbGxpZGVPYmplY3Qob2JqZWN0KSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDE0LjEyLjIwMjFcbiAgICAgICAgICogQ29sbGlzaW9ucyB3aXRoIHRpbGVzIG11c3QgYmUgY2hlY2tlZCBiZWZvcmUgY29sbGlzaW9ucyB3aXRoIHdvcmxkIGJvdW5kcmllcyxcbiAgICAgICAgICogYmVjYXVzZSBjb2xsaXNpb24gd2l0aCB3b3JsZCBib3JkZXIgbWlnaHQgcGxhY2UgcGxheWVyIGluc2lkZSBhIHRpbGUsIHNvIHRoYXRcbiAgICAgICAgICogY29sbGlzaW9uIHR5cGUgd2lsbCBub3QgYmUgZGV0ZWN0ZWQgYW5kIHBsYXllciBjb3VsZCBtb3ZlIG91dHNpZGUgdGhlIHdvbHJkIFxuICAgICAgICAgKi9cblxuICAgICAgICBsZXQgbGVmdCwgcmlnaHQsIHRvcCwgYm90dG9tLCBjb2xsaXNpb25WYWx1ZTtcblxuICAgICAgICBsZWZ0ICAgICAgICAgICAgPSBNYXRoLmZsb29yKChvYmplY3QuZ2V0TGVmdCgpIC0gdGhpcy5vZmZzZXRYKSAvIHRoaXMudGlsZVNpemUpO1xuICAgICAgICB0b3AgICAgICAgICAgICAgPSBNYXRoLmZsb29yKChvYmplY3QuZ2V0VG9wKCkgLSB0aGlzLm9mZnNldFkpIC8gdGhpcy50aWxlU2l6ZSk7XG4gICAgICAgIGNvbGxpc2lvblZhbHVlICA9IHRoaXMuY29sbGlzaW9uTWFwW3RvcCAqIHRoaXMuY29sdW1ucyArIGxlZnRdO1xuICAgICAgICB0aGlzLmNvbGxpZGVyLmNvbGxpZGUoY29sbGlzaW9uVmFsdWUsIG9iamVjdCwgbGVmdCAqIHRoaXMudGlsZVNpemUsIHRvcCAqIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUsIHRoaXMub2Zmc2V0WCwgdGhpcy5vZmZzZXRZKTtcblxuICAgICAgICByaWdodCAgICAgICAgICAgPSBNYXRoLmZsb29yKChvYmplY3QuZ2V0UmlnaHQoKSAtIHRoaXMub2Zmc2V0WCkgLyB0aGlzLnRpbGVTaXplKTtcbiAgICAgICAgdG9wICAgICAgICAgICAgID0gTWF0aC5mbG9vcigob2JqZWN0LmdldFRvcCgpIC0gdGhpcy5vZmZzZXRZKSAvIHRoaXMudGlsZVNpemUpO1xuICAgICAgICBjb2xsaXNpb25WYWx1ZSAgPSB0aGlzLmNvbGxpc2lvbk1hcFt0b3AgKiB0aGlzLmNvbHVtbnMgKyByaWdodF07XG4gICAgICAgIHRoaXMuY29sbGlkZXIuY29sbGlkZShjb2xsaXNpb25WYWx1ZSwgb2JqZWN0LCByaWdodCAqIHRoaXMudGlsZVNpemUsIHRvcCAqIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUsIHRoaXMub2Zmc2V0WCwgdGhpcy5vZmZzZXRZKTtcblxuICAgICAgICBsZWZ0ICAgICAgICAgICAgPSBNYXRoLmZsb29yKChvYmplY3QuZ2V0TGVmdCgpIC0gdGhpcy5vZmZzZXRYKSAvIHRoaXMudGlsZVNpemUpO1xuICAgICAgICBib3R0b20gICAgICAgICAgPSBNYXRoLmZsb29yKChvYmplY3QuZ2V0Qm90dG9tKCkgLSB0aGlzLm9mZnNldFkpIC8gdGhpcy50aWxlU2l6ZSk7XG4gICAgICAgIGNvbGxpc2lvblZhbHVlICA9IHRoaXMuY29sbGlzaW9uTWFwW2JvdHRvbSAqIHRoaXMuY29sdW1ucyArIGxlZnRdO1xuICAgICAgICB0aGlzLmNvbGxpZGVyLmNvbGxpZGUoY29sbGlzaW9uVmFsdWUsIG9iamVjdCwgbGVmdCAqIHRoaXMudGlsZVNpemUsIGJvdHRvbSAqIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUsIHRoaXMub2Zmc2V0WCwgdGhpcy5vZmZzZXRZKTtcblxuICAgICAgICByaWdodCAgICAgICAgICAgPSBNYXRoLmZsb29yKChvYmplY3QuZ2V0UmlnaHQoKSAtIHRoaXMub2Zmc2V0WCkgLyB0aGlzLnRpbGVTaXplKTtcbiAgICAgICAgYm90dG9tICAgICAgICAgID0gTWF0aC5mbG9vcigob2JqZWN0LmdldEJvdHRvbSgpIC0gdGhpcy5vZmZzZXRZKSAvIHRoaXMudGlsZVNpemUpO1xuICAgICAgICBjb2xsaXNpb25WYWx1ZSAgPSB0aGlzLmNvbGxpc2lvbk1hcFtib3R0b20gKiB0aGlzLmNvbHVtbnMgKyByaWdodF07XG4gICAgICAgIHRoaXMuY29sbGlkZXIuY29sbGlkZShjb2xsaXNpb25WYWx1ZSwgb2JqZWN0LCByaWdodCAqIHRoaXMudGlsZVNpemUsIGJvdHRvbSAqIHRoaXMudGlsZVNpemUsIHRoaXMudGlsZVNpemUsIHRoaXMub2Zmc2V0WCwgdGhpcy5vZmZzZXRZKTtcblxuXG4gICAgICAgIC8qKlxuICAgICAgICAgICAgICogb2JqZWN0J3MgdmVsb2NpdHlYIGlzIHJvdW5kZWQgc28gdGhhdCB0aWxlIG1hcCBpcyBtb3Zpbmcgc21vb3RobHksXG4gICAgICAgICAgICAgKiBvdGhlcndpc2UgdGlsZXMgbW92ZSBieSBub25kZWNpbWFsIHZhbHVlcyBhbmQgdGhlbiBncmFwaGljcyBpc24ndFxuICAgICAgICAgICAgICogcmVuZGVyZWQgaW4gc29saWQgY29sb3IsIGJ1dCBpdCBoYXMgc3RyaXBlcyBpbiBkaWZmZXJlbnQgY29sb3JcbiAgICAgICAgKi9cblxuICAgICAgICBpZiAob2JqZWN0LmdldExlZnQoKSA8IHRoaXMudGlsZVNpemUpIHtcblxuICAgICAgICAgICAgdGhpcy5vZmZzZXRYICs9IHRoaXMudGlsZVNpemUgLSBvYmplY3QuZ2V0TGVmdCgpO1xuICAgICAgICAgICAgb2JqZWN0LnNldExlZnQodGhpcy50aWxlU2l6ZSk7XG4gICAgICAgICAgICAvLyBvYmplY3QudmVsb2NpdHlYID0gMDtcblxuICAgICAgICB9XG4gICAgICAgIGlmIChvYmplY3QuZ2V0UmlnaHQoKSA+IHRoaXMud2lkdGggLSB0aGlzLnRpbGVTaXplKSB7IFxuXG4gICAgICAgICAgICB0aGlzLm9mZnNldFggKz0gLXRoaXMudGlsZVNpemUgKyB0aGlzLndpZHRoIC0gb2JqZWN0LmdldFJpZ2h0KCk7XG4gICAgICAgICAgICBvYmplY3Quc2V0UmlnaHQodGhpcy53aWR0aCAtIHRoaXMudGlsZVNpemUpO1xuICAgICAgICAgICAgLy8gb2JqZWN0LnZlbG9jaXR5WCA9IDA7XG5cbiAgICAgICAgfVxuICAgICAgICBpZiAob2JqZWN0LmdldFRvcCgpIDwgdGhpcy50aWxlU2l6ZSkgeyBcbiAgICAgICAgXG4gICAgICAgICAgICB0aGlzLm9mZnNldFkgKz0gdGhpcy50aWxlU2l6ZSAtIG9iamVjdC5nZXRUb3AoKTtcbiAgICAgICAgICAgIG9iamVjdC5zZXRUb3AodGhpcy50aWxlU2l6ZSk7XG5cbiAgICAgICAgfVxuICAgICAgICBpZiAob2JqZWN0LmdldEJvdHRvbSgpID4gdGhpcy5oZWlnaHQgLSB0aGlzLnRpbGVTaXplKSB7IFxuICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5vZmZzZXRZICs9IC10aGlzLnRpbGVTaXplICsgdGhpcy5oZWlnaHQgLSBvYmplY3QuZ2V0Qm90dG9tKCk7XG4gICAgICAgICAgICBvYmplY3Quc2V0Qm90dG9tKHRoaXMuaGVpZ2h0IC0gdGhpcy50aWxlU2l6ZSk7XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgdXBkYXRlKCkge1xuXG4gICAgICAgIHRoaXMucGxheWVyLnZlbG9jaXR5WSArPSB0aGlzLmdyYXZpdHk7XG4gICAgICAgIHRoaXMucGxheWVyLnZlbG9jaXR5WCAqPSB0aGlzLmZyaWN0aW9uO1xuXG4gICAgICAgIHRoaXMucGxheWVyLnZlbG9jaXR5WSA9IE1hdGgubWluKHRoaXMucGxheWVyLnZlbG9jaXR5WSwgdGhpcy50aWxlU2l6ZSk7XG5cbiAgICAgICAgdGhpcy5wbGF5ZXIudXBkYXRlKCk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNvbGxpZGVPYmplY3QodGhpcy5wbGF5ZXIpOyAgICAgICAgXG5cbiAgICB9XG4gICAgXG59XG5cbkdhbWUuVGlsZSA9IGNsYXNzIGV4dGVuZHMgR2FtZS5SZWN0YW5nbGUge1xuICAgIGNvbnN0cnVjdG9yKHgsIHksIHdpZHRoLCBoZWlnaHQsIGlkKSB7XG4gICAgICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xuICAgIFxuICAgICAgICB0aGlzLmlkID0gaWQ7XG5cbiAgICB9XG59XG5cbkdhbWUuV29ybGQuQ29sbGlkZXIgPSBjbGFzcyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG5cblxuXG4gICAgfVxuXG4gICAgY29sbGlkZShjb2xsaXNpb25WYWx1ZSwgb2JqZWN0LCB0aWxlWCwgdGlsZVksIHRpbGVTaXplLCBvZmZzZXRYLCBvZmZzZXRZKSB7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDEyLjEyLjIwMjEgTWF0ZXVzeiBLYXJhbmR5c1xuICAgICAgICAgKiBcbiAgICAgICAgICogV2hlbiBwbGF5ZXIgaXMgc3RhbmRpbmcgb24gdG9wIG9mIGEgYmxvY2sgY29sbGlkZVBsYXRmb3JtVG9wIHJldHVybnMgdHJ1ZSBpbiBldmVyeSBpdGVyYXRpb24sIHRoZXJlZm9yZVxuICAgICAgICAgKiBubyBtb3JlIGNvbGxpc2lvbiBpcyBkZXRlY3RlZC4gV2hlbiBwbGF5ZXIgaGFzIHRoZSBzYW1lIHNpemUgYXMgdGlsZXMgY29sbGlkZVBsYXRmb3JtQm90dG9tIGNhbid0IGJlIGNhbGxlZFxuICAgICAgICAgKiBpbiBjb25maWd1cmF0aW9uOiBjb2xsaWRlUGxhdGZvcm1Ub3AsIGNvbGxpZGVQbGF0Zm9ybUxlZnQvUmlnaHQsIGNvbGxpZGVQbGF0Zm9ybUJvdHRvbSwgc28gcGxheWVyIGNhbiBqdW1wIFxuICAgICAgICAgKiBvdmVyIHRoZSBjZWlsaW5nXG4gICAgICAgICAqIFxuICAgICAgICAgKiBEb24ndCBrbm93IGhvdyB0byBtYWtlIGl0IHdvcmtzLCB3aGVuIHBsYXllciBhbmQgdGlsZXMgYXJlIHRoZSBzYW1lIHNpemUsIGNvbGxpc2lvbiBjaGVja2luZyBvcmRlciBpc24ndCBlbm91Z2hcbiAgICAgICAgICogKG9yIGlzIGl0PylcbiAgICAgICAgICogXG4gICAgICAgICAqIEZvciB0aGUgbW9tZW50IGtlZXAgcGxheWVyIHNtYWxsZXIgdGhhbiB0aWxlc1xuICAgICAgICAgKiBcbiAgICAgICAgICogSWRlYSAjMTogaW4gY29sbGlkZVBsYXRmcm9tIGZ1bmN0aW9ucyBhZGQgb3Igc3VidHJhY3QgMC4wMSBmcm9tIHRpbGUgY29vcmRpbmF0ZXMsIHNvIGNvbGxpc2lvbiBpcyBjaGVja2VkIGFib3ZlIHRpbGVUb3AsXG4gICAgICAgICAqIHVuZGVyIHRpbGVCb3R0b20sIG9uIHRoZSByaWdodCBvZiB0aWxlUmlnaHQgb3Igb24gdGhlIGxlZnQgb2YgdGlsZUxlZnQsIGV4YW1wbGU6XG4gICAgICAgICAqIFxuICAgICAgICAgKiAgICAgIHRoaXMuY29sbGlkZVBsYXRmb3JtVG9wKG9iamVjdCwgdGlsZVkgKyBvZmZzZXRZIC0gMC4wMSlcbiAgICAgICAgICogXG4gICAgICAgICAqICsvLSAwLjAxIGNhbiBiZSB0YWtlIGludG8gYWNjb3VudCBpbnNpZGUgY29sbGlkZVBsYXRmb3JtIGZ1bmN0aW9ucywgbm90IGFzIGEgcGFyYW1ldGVyXG4gICAgICAgICAqL1xuXG4gICAgICAgIHN3aXRjaCAoY29sbGlzaW9uVmFsdWUpIHtcblxuICAgICAgICAgICAgY2FzZSAxOiBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sbGlkZVBsYXRmb3JtVG9wKG9iamVjdCwgdGlsZVkgKyBvZmZzZXRZIC0gMC4wMSkpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29sbGlkZVBsYXRmb3JtTGVmdChvYmplY3QsIHRpbGVYICsgb2Zmc2V0WCAtIDAuMDEpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbGxpZGVQbGF0Zm9ybVJpZ2h0KG9iamVjdCwgdGlsZVggKyB0aWxlU2l6ZSArIG9mZnNldFggKyAwLjAxKSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb2xsaWRlUGxhdGZvcm1Cb3R0b20ob2JqZWN0LCB0aWxlWSArIHRpbGVTaXplICsgb2Zmc2V0WSArIDAuMDEpKSByZXR1cm47O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBjb2xsaWRlUGxhdGZvcm1MZWZ0KG9iamVjdCwgdGlsZUxlZnQpIHtcblxuICAgICAgICBpZiAob2JqZWN0LmdldFJpZ2h0KCkgPiB0aWxlTGVmdCAmJiBvYmplY3QuZ2V0T2xkUmlnaHQoKSA8PSB0aWxlTGVmdCkge1xuXG4gICAgICAgICAgICBvYmplY3Quc2V0UmlnaHQodGlsZUxlZnQgLSAwLjAxKTtcbiAgICAgICAgICAgIG9iamVjdC52ZWxvY2l0eVggPSAwO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgfVxuXG4gICAgY29sbGlkZVBsYXRmb3JtUmlnaHQob2JqZWN0LCB0aWxlUmlnaHQpIHtcblxuICAgICAgICBpZiAob2JqZWN0LmdldExlZnQoKSA8IHRpbGVSaWdodCAmJiBvYmplY3QuZ2V0T2xkTGVmdCgpID49IHRpbGVSaWdodCkge1xuXG4gICAgICAgICAgICBvYmplY3Quc2V0TGVmdCh0aWxlUmlnaHQgKyAwLjAxKTtcbiAgICAgICAgICAgIG9iamVjdC52ZWxvY2l0eVggPSAwO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgfVxuXG4gICAgY29sbGlkZVBsYXRmb3JtVG9wKG9iamVjdCwgdGlsZVRvcCkge1xuXG4gICAgICAgIGlmIChvYmplY3QuZ2V0Qm90dG9tKCkgPiB0aWxlVG9wICYmIG9iamVjdC5nZXRPbGRCb3R0b20oKSA8PSB0aWxlVG9wKSB7XG5cbiAgICAgICAgICAgIG9iamVjdC5zZXRCb3R0b20odGlsZVRvcCAtIDAuMDEpO1xuICAgICAgICAgICAgb2JqZWN0LnZlbG9jaXR5WSA9IDA7XG4gICAgICAgICAgICBvYmplY3QuanVtcENvdW50ZXIgPSAwO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgfVxuXG4gICAgY29sbGlkZVBsYXRmb3JtQm90dG9tKG9iamVjdCwgdGlsZUJvdHRvbSkge1xuXG4gICAgICAgIGlmIChvYmplY3QuZ2V0VG9wKCkgPCB0aWxlQm90dG9tICYmIG9iamVjdC5nZXRPbGRUb3AoKSA+PSB0aWxlQm90dG9tKSB7XG5cbiAgICAgICAgICAgIG9iamVjdC5zZXRUb3AodGlsZUJvdHRvbSk7XG4gICAgICAgICAgICBvYmplY3QudmVsb2NpdHlZID0gMDtcblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgR2FtZTtcbiIsIi8qIGVzbGludC1kaXNhYmxlICovXG5cbmltcG9ydCBDb250cm9sbGVyIGZyb20gJy4vY29udHJvbGxlcic7XG5pbXBvcnQgRGlzcGxheSBmcm9tICcuL2Rpc3BsYXknO1xuaW1wb3J0IEdhbWUgZnJvbSAnLi9nYW1lJztcbmltcG9ydCBFbmdpbmUgZnJvbSAnLi9lbmdpbmUnO1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIChldmVudCkgPT4ge1xuXG4gICAgY29uc3Qga2V5RG93blVwID0gZnVuY3Rpb24gKGV2ZW50KSB7XG5cbiAgICAgICAgY29udHJvbGxlci5rZXlEb3duVXAoZXZlbnQudHlwZSwgZXZlbnQua2V5Q29kZSk7XG5cbiAgICB9O1xuXG4gICAgY29uc3QgcmVzaXplID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGRpc3BsYXkucmVzaXplKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIDMyLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMzIsIFxuICAgICAgICAgICAgZ2FtZS5sZXZlbC5oZWlnaHQgLyBnYW1lLmxldmVsLndpZHRoKTtcbiAgICAgICAgZGlzcGxheS5yZW5kZXIoKTtcblxuICAgIH07XG5cbiAgICBjb25zdCByZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgZGlzcGxheS5maWxsKGdhbWUubGV2ZWwuYmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgXG4gICAgICAgIGdhbWUubGV2ZWwud29ybGQubWFwLmZvckVhY2godGlsZSA9PiB7XG5cbiAgICAgICAgICAgIGRpc3BsYXkuZHJhd1RpbGUodGlsZS54ICsgZ2FtZS5sZXZlbC53b3JsZC5vZmZzZXRYLCB0aWxlLnkgKyBnYW1lLmxldmVsLndvcmxkLm9mZnNldFksIHRpbGUud2lkdGgsIHRpbGUuaGVpZ2h0LCB0aWxlLmlkKTtcblxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGRpc3BsYXkuZHJhd1BsYXllcihnYW1lLmxldmVsLndvcmxkLnBsYXllci54LCBnYW1lLmxldmVsLndvcmxkLnBsYXllci55LCBnYW1lLmxldmVsLndvcmxkLnBsYXllci53aWR0aCwgZ2FtZS5sZXZlbC53b3JsZC5wbGF5ZXIuaGVpZ2h0LCBnYW1lLmxldmVsLndvcmxkLnBsYXllci5jb2xvcik7XG4gICAgICAgIFxuICAgICAgICBkaXNwbGF5LnJlbmRlcigpO1xuXG4gICAgfVxuXG4gICAgY29uc3QgdXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGlmIChjb250cm9sbGVyLmxlZnQuYWN0aXZlKSAgeyBnYW1lLmxldmVsLndvcmxkLnBsYXllci5tb3ZlTGVmdCgpOyB9XG4gICAgICAgIGlmIChjb250cm9sbGVyLnJpZ2h0LmFjdGl2ZSkgeyBnYW1lLmxldmVsLndvcmxkLnBsYXllci5tb3ZlUmlnaHQoKTsgfVxuICAgICAgICBpZiAoY29udHJvbGxlci51cC5hY3RpdmUpICAgIHsgZ2FtZS5sZXZlbC53b3JsZC5wbGF5ZXIuanVtcCgpOyBjb250cm9sbGVyLnVwLmFjdGl2ZSA9IGZhbHNlOyB9XG5cbiAgICAgICAgZ2FtZS51cGRhdGUoKTtcblxuICAgIH07XG5cblxuXG5cblxuICAgIGxldCBjb250cm9sbGVyID0gbmV3IENvbnRyb2xsZXIoKTtcblxuICAgIGxldCBkaXNwbGF5ICAgID0gbmV3IERpc3BsYXkoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJykpO1xuXG4gICAgbGV0IGdhbWUgICAgICAgPSBuZXcgR2FtZSgpO1xuXG4gICAgbGV0IGVuZ2luZSAgICAgPSBuZXcgRW5naW5lKDEwMDAgLyAzMCwgdXBkYXRlLCByZW5kZXIpO1xuXG4gICAgZGlzcGxheS5idWZmZXIuY2FudmFzLndpZHRoID0gZ2FtZS5sZXZlbC53aWR0aDtcbiAgICBkaXNwbGF5LmJ1ZmZlci5jYW52YXMuaGVpZ2h0ID0gZ2FtZS5sZXZlbC5oZWlnaHQ7XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGtleURvd25VcCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgICBrZXlEb3duVXApO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAgcmVzaXplKTtcblxuICAgIHJlc2l6ZSgpO1xuXG4gICAgZ2FtZS5pbml0KCk7XG4gICAgZW5naW5lLnN0YXJ0KCk7XG5cbn0pO1xuIiwiY2xhc3MgRGlzcGxheSB7XG4gICAgY29uc3RydWN0b3IoY2FudmFzKSB7XG5cbiAgICAgICAgdGhpcy5idWZmZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKS5nZXRDb250ZXh0KCcyZCcpO1xuICAgICAgICB0aGlzLmNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgIH1cblxuICAgIGRyYXdQbGF5ZXIoeCwgeSwgd2lkdGgsIGhlaWdodCwgY29sb3IpIHtcblxuICAgICAgICB0aGlzLmJ1ZmZlci5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICAgICAgdGhpcy5idWZmZXIuZmlsbFJlY3QoTWF0aC5yb3VuZCh4KSwgTWF0aC5yb3VuZCh5KSwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICB9XG5cbiAgICBkcmF3VGlsZSh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBpZCkge1xuXG4gICAgICAgIHRoaXMuYnVmZmVyLmZpbGxTdHlsZSA9ICcjZjBmJztcbiAgICAgICAgdGhpcy5idWZmZXIuZmlsbFJlY3QoeCwgeSwgd2lkdGgsIGhlaWdodCk7ICAgICAgICBcblxuICAgIH1cblxuICAgIGZpbGwoY29sb3IpIHtcblxuICAgICAgICB0aGlzLmJ1ZmZlci5maWxsU3R5bGUgPSBjb2xvcjtcbiAgICAgICAgdGhpcy5idWZmZXIuZmlsbFJlY3QoMCwgMCwgdGhpcy5idWZmZXIuY2FudmFzLndpZHRoLCB0aGlzLmJ1ZmZlci5jYW52YXMuaGVpZ2h0KTtcblxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcblxuICAgICAgICB0aGlzLmNvbnRleHQuZHJhd0ltYWdlKFxuICAgICAgICAgICAgdGhpcy5idWZmZXIuY2FudmFzLFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIDAsXG4gICAgICAgICAgICB0aGlzLmJ1ZmZlci5jYW52YXMud2lkdGgsXG4gICAgICAgICAgICB0aGlzLmJ1ZmZlci5jYW52YXMuaGVpZ2h0LFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIDAsXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuY2FudmFzLndpZHRoLFxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmNhbnZhcy5oZWlnaHRcbiAgICAgICAgICAgICk7XG5cbiAgICB9XG5cbiAgICByZXNpemUod2lkdGgsIGhlaWdodCwgcmF0aW8pIHtcblxuICAgICAgICBpZiAoaGVpZ2h0IC8gd2lkdGggPiByYXRpbykge1xuXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuY2FudmFzLmhlaWdodCA9IHdpZHRoICogcmF0aW87XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuY2FudmFzLndpZHRoID0gd2lkdGg7XG5cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuY2FudmFzLndpZHRoID0gaGVpZ2h0IC8gcmF0aW87XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29udGV4dC5pbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcblxuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGlzcGxheTtcbiIsImNsYXNzIEVuZ2luZSB7XG4gICAgY29uc3RydWN0b3IodGltZVN0ZXAsIHVwZGF0ZSwgcmVuZGVyKSB7XG5cbiAgICAgICAgdGhpcy5hY2N1bXVsYXRlZFRpbWUgICAgICAgPSAwO1xuICAgICAgICB0aGlzLmFuaW1hdGlvbkZyYW1lUmVxdWVzdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy50aW1lICAgICAgICAgICAgICAgICAgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMudGltZVN0ZXAgICAgICAgICAgICAgID0gdGltZVN0ZXA7XG5cbiAgICAgICAgdGhpcy51cGRhdGVkID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy51cGRhdGUgPSB1cGRhdGU7XG4gICAgICAgIHRoaXMucmVuZGVyID0gcmVuZGVyO1xuXG4gICAgfVxuXG4gICAgaGFuZGxlUnVuKHRpbWVTdGVwKSB7XG5cbiAgICAgICAgdGhpcy5ydW4odGltZVN0ZXApO1xuXG4gICAgfVxuXG4gICAgcnVuKHRpbWVTdGFtcCkge1xuXG4gICAgICAgIHRoaXMuYWNjdW11bGF0ZWRUaW1lICs9IHRpbWVTdGFtcCAtIHRoaXMudGltZTtcbiAgICAgICAgdGhpcy50aW1lID0gdGltZVN0YW1wO1xuXG4gICAgICAgIHdoaWxlICh0aGlzLmFjY3VtdWxhdGVkVGltZSA+PSB0aGlzLnRpbWVTdGVwKSB7XG5cbiAgICAgICAgICAgIHRoaXMuYWNjdW11bGF0ZWRUaW1lIC09IHRoaXMudGltZVN0ZXA7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSgvKiB0aW1lU3RhbXAgKi8pO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVkID0gdHJ1ZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMudXBkYXRlZCkge1xuXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKC8qIHRpbWVTdGFtcCAqLyk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIEluIGZ1bmN0aW9uIGJlbG93IEkgYmluZCAndGhpcycgdG8gaGFuZGxlUnVuIG1ldGhvZCwgYmVjYXVzZSBwYXNzaW5nIG9ubHkgdGhpcy5oYW5kbGVSdW5cbiAgICAgICAgICogZG9lc24ndCBrZWVwIHRoaXMgYXMgRW5naW5lIGNsYXNzXG4gICAgICAgICovXG4gICAgICAgXG4gICAgICAgIHRoaXMuYW5pbWF0aW9uRnJhbWVSZXF1ZXN0ID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmhhbmRsZVJ1bi5iaW5kKHRoaXMpKTtcblxuICAgIH1cblxuICAgIHN0YXJ0KCkge1xuXG4gICAgICAgIHRoaXMuYWNjdW11bGF0ZWRUaW1lID0gdGhpcy50aW1lU3RlcDtcbiAgICAgICAgdGhpcy50aW1lID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICB0aGlzLmFuaW1hdGlvbkZyYW1lUmVxdWVzdCA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5oYW5kbGVSdW4uYmluZCh0aGlzKSk7XG5cbiAgICB9XG5cbiAgICBzdG9wKCkge1xuXG4gICAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLmFuaW1hdGlvbkZyYW1lUmVxdWVzdCk7XG5cbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEVuZ2luZTtcbiJdLCJuYW1lcyI6WyJDb250cm9sbGVyIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwibGVmdCIsIkJ1dHRvbklucHV0IiwicmlnaHQiLCJ1cCIsImtleURvd25VcCIsInR5cGUiLCJrZXlDb2RlIiwiZG93biIsImdldElucHV0IiwiYWN0aXZlIiwiR2FtZSIsImxldmVsIiwiYmFja2dyb3VuZENvbG9yIiwiaGVpZ2h0Iiwid2lkdGgiLCJ3b3JsZCIsIldvcmxkIiwiaW5pdCIsInVwZGF0ZSIsIlJlY3RhbmdsZSIsIngiLCJ5Iiwib2xkWCIsIm9sZFkiLCJzZXRMZWZ0Iiwic2V0UmlnaHQiLCJzZXRUb3AiLCJzZXRCb3R0b20iLCJnZXRMZWZ0IiwiZ2V0UmlnaHQiLCJnZXRUb3AiLCJnZXRCb3R0b20iLCJzZXRPbGRMZWZ0Iiwic2V0T2xkUmlnaHQiLCJzZXRPbGRUb3AiLCJzZXRPbGRCb3R0b20iLCJnZXRPbGRMZWZ0IiwiZ2V0T2xkUmlnaHQiLCJnZXRPbGRUb3AiLCJnZXRPbGRCb3R0b20iLCJQbGF5ZXIiLCJzdXBlciIsImNvbG9yIiwidmVsb2NpdHkiLCJqdW1wQ291bnRlciIsInZlbG9jaXR5WCIsInZlbG9jaXR5WSIsImp1bXAiLCJtb3ZlTGVmdCIsIm1vdmVSaWdodCIsImNvbnNvbGUiLCJsb2ciLCJsZXZlbElkIiwibWFwU2tldGNoIiwiY29sbGlzaW9uTWFwIiwiY29sbGlkZXIiLCJDb2xsaWRlciIsImNvbHVtbnMiLCJyb3dzIiwidGlsZVNpemUiLCJtYXAiLCJwbGF5ZXIiLCJncmF2aXR5IiwiZnJpY3Rpb24iLCJvZmZzZXRYIiwib2Zmc2V0WSIsImluaXRNYXAiLCJpIiwibGVuZ3RoIiwicHVzaCIsIlRpbGUiLCJNYXRoIiwiZmxvb3IiLCJjb2xsaWRlT2JqZWN0Iiwib2JqZWN0IiwidG9wIiwiYm90dG9tIiwiY29sbGlzaW9uVmFsdWUiLCJjb2xsaWRlIiwibWluIiwiaWQiLCJ0aWxlWCIsInRpbGVZIiwiY29sbGlkZVBsYXRmb3JtVG9wIiwiY29sbGlkZVBsYXRmb3JtTGVmdCIsImNvbGxpZGVQbGF0Zm9ybVJpZ2h0IiwiY29sbGlkZVBsYXRmb3JtQm90dG9tIiwidGlsZUxlZnQiLCJ0aWxlUmlnaHQiLCJ0aWxlVG9wIiwidGlsZUJvdHRvbSIsIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImNvbnRyb2xsZXIiLCJyZXNpemUiLCJkaXNwbGF5IiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImNsaWVudEhlaWdodCIsImdhbWUiLCJyZW5kZXIiLCJjYW52YXMiLCJidWZmZXIiLCJjcmVhdGVFbGVtZW50IiwiZ2V0Q29udGV4dCIsImNvbnRleHQiLCJkcmF3UGxheWVyIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJyb3VuZCIsImRyYXdUaWxlIiwiZmlsbCIsImRyYXdJbWFnZSIsInJhdGlvIiwiaW1hZ2VTbW9vdGhpbmdFbmFibGVkIiwicXVlcnlTZWxlY3RvciIsImVuZ2luZSIsInRpbWVTdGVwIiwiYWNjdW11bGF0ZWRUaW1lIiwiYW5pbWF0aW9uRnJhbWVSZXF1ZXN0IiwidW5kZWZpbmVkIiwidGltZSIsInVwZGF0ZWQiLCJoYW5kbGVSdW4iLCJydW4iLCJ0aW1lU3RhbXAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJiaW5kIiwic3RhcnQiLCJwZXJmb3JtYW5jZSIsIm5vdyIsInN0b3AiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImZvckVhY2giLCJ0aWxlIl0sInNvdXJjZVJvb3QiOiIifQ==